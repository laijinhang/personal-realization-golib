> raft是解决分布式下数据一致的一种算法，它的目的不是实时一致（实时一致非常难），而是保证数据最终一致

场景：
1. 微服务：服务发现ectd
2. 区块链应用
3. 分布式应用中

适合于同步数据和共识，对于分布式中的算法，也有主从复制来保持数据的一致

# 原理
raft算法有三个角色：
1. 领导者（可以理解成主节点）
2. 候选者（可以理解成为解决主节点错误时，不能工作的问题）
3. 跟随者（可以理解成从节点）

三个角色的功能：
1. 领导者：
    1. 系统的所有更改都是通过领导者，然后领导者告诉其他节点，什么数据添加进来了，什么数据被删除了，什么数据被修改了，等等
2. 候选者：
    1. 发送信息给其余节点，让节点投自己一票
    2. 成为领导者
    3. 成为跟随者
3. 跟随者：
    1. 接收和处理领导者的消息

工作原理：
在实现中，起始时，每个节点都是一样的。在整个分布式数据同步一致时，会做哪些工作？
1. 成为候选人
2. 领导人选举
3. 领导人心跳机制（保活 + 同步数据）

raft中实现的是：当分布式集群中不存在领导者的时候，每个节点会尝试让自己成为候选人。从这边引出两个问题
1. 节点怎么去识别存不存在领导者？
2. 节点怎么去让自己成为候选人？
这边就引出领导者保活机制（类似TCP保活机制那样），每个节点会与领导者建立连接，领导者会定时发送数据给节点（一是告诉节点，我还活着，二是，传数据），每个节点都有一个定时器，当定时器到了，这个节点就认为领导者不在了，每次接收到领导者的信息，都会将这个定时器进行置零操作，这样就完成识别领导者是否存在的问题了。
节点怎么去让自己成为候选人？当节点知道领导者不在时，它起动一个定时器，在这个定时器未完成时，如果收到其他节点想成为一个候选人，则当前这个节点就不成为候选人了，并且给那个节点一个消息，我选你了（其实也就是当前节点知道，那个节点要成为候选人，并且当那个节点收到时，它知道有节点知道自己成为候选人了，此时会更改自己的状态）
此时，又冒出了一个问题，那就是，如果有节点与大组织失联了。。。，因为这个问题，引出了什么时候候选人可以成为领导人？也就是当候选人知道当前集群中有一半以上的节点知道我是候选人时，我就成为领导者，这个时候，向集群广播，有领导者了，那么此时有其他候选人或者想成为候选人的都会放弃当前念头，与领导者建立连接。
还有一种情况就是多个候选人，都想成为领导者，并且都相同票数（节点收到多个节点，但是只能投一篇），这时就要重新选择候选人了。

了解了raft算法的工作原理之后，下面来实现一个最基础的raft实现（其他，不过也是在这基础上加上具体场景，然后去解决相应的问题而已）
# 代码（简易实现）
代码实现的难点在于：
1. 任务进度的控制
2. 网络中的不确定性

能够进行选举领导者，并向完成跟随者与领导者之间的通信

* 启动节点一：go main.go 1
* 启动节点二：go main.go 2
* 启动节点三：go main.go 3
* 启动节点四：go main.go 4
* 启动节点五：go main.go 5

# 测试
# raft学习资源
* [视频 30多分钟](https://v.qq.com/x/page/g0930y6bkt2.html)
* goraft: https://github.com/goraft/raft
